define(["jquery","datatables"],function(a){function b(b,d){require(["text!overlay/overlay_remove.html"],function(e){e=a(e),e.hide(),e.appendTo("body"),c=e.find("table").DataTable({paging:!1,scrollY:200,info:!1}),a(".overlay_dialog_remove").dialog({autoOpen:!1,resizable:!1,width:330,modal:!0,my:"center",at:"center",of:window,buttons:[{text:"Remove Selected",click:function(){var b=c.rows(".selected").data().length;b>0?require(["currentPriceIndicator"],function(b){var d=a(".overlay_dialog_remove").data("refererChartID");c.rows(".selected").nodes().to$().each(function(){var e=a(this).data("id"),f=a(d).highcharts();if(f&&e){var g=f.get(e);g&&(a.each(b.getCurrentPriceOptions(),function(a,b){return b&&g.options&&g.options.id&&b.parentSeriesID==g.options.id?(g.removeCurrentPrice(a),!1):void 0}),g.remove())}c.row(a(this)).remove().draw()})}):a.growl.error({message:"Please select instruments to remove"})}},{text:"Cancel",click:function(){a(".overlay_dialog_remove").dialog("close")}}]}),"function"==typeof d&&d(b)})}var c=void 0;return{openDialog:function(d){if(0==a(".overlay_dialog_remove").length)return void b(d,this.openDialog);c.clear().draw();var e=a(d).highcharts();e&&(a.each(e.series,function(b,d){d.options.isInstrument&&b>0&&"navigator"!==d.options.id&&a(c.row.add([d.options.name]).draw().node()).click(function(){a(this).toggleClass("selected")}).data({id:d.options.id})}),a(".overlay_dialog_remove").data("refererChartID",d).dialog("open"))}}});